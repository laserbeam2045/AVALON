(function(t){function e(e){for(var n,o,s=e[0],c=e[1],u=e[2],d=0,l=[];d<s.length;d++)o=s[d],r[o]&&l.push(r[o][0]),r[o]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(t[n]=c[n]);h&&h(e);while(l.length)l.shift()();return a.push.apply(a,u||[]),i()}function i(){for(var t,e=0;e<a.length;e++){for(var i=a[e],n=!0,s=1;s<i.length;s++){var c=i[s];0!==r[c]&&(n=!1)}n&&(a.splice(e--,1),t=o(o.s=i[0]))}return t}var n={},r={app:0},a=[];function o(e){if(n[e])return n[e].exports;var i=n[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,o),i.l=!0,i.exports}o.m=t,o.c=n,o.d=function(t,e,i){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(o.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)o.d(i,n,function(e){return t[e]}.bind(null,n));return i},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=e,s=s.slice();for(var u=0;u<s.length;u++)e(s[u]);var h=c;a.push([0,"chunk-vendors"]),i()})({0:function(t,e,i){t.exports=i("56d7")},"034f":function(t,e,i){"use strict";var n=i("64a9"),r=i.n(n);r.a},"03a7":function(t,e,i){"use strict";var n=i("8f1b"),r=i.n(n);r.a},"08a2":function(t,e,i){},"0b9e":function(t,e,i){"use strict";var n=i("1f62"),r=i.n(n);r.a},"0e56":function(t,e,i){t.exports=i.p+"img/drop_9.b295fbb9.png"},"0e59":function(t,e,i){t.exports=i.p+"img/drops.7a24049d.png"},1033:function(t,e,i){},1635:function(t,e,i){t.exports=i.p+"img/drop_4.4a0b850b.png"},"1c2a":function(t,e,i){"use strict";var n=i("561e"),r=i.n(n);r.a},"1f28":function(t,e,i){t.exports=i.p+"media/cursor1.0c1332b4.mp3"},"1f62":function(t,e,i){},2760:function(t,e,i){},"2dbc":function(t,e,i){"use strict";var n=i("a39d"),r=i.n(n);r.a},"30ab":function(t,e,i){"use strict";var n=i("8e46"),r=i.n(n);r.a},"37c5":function(t,e,i){t.exports=i.p+"img/drop_6_2.29bf505e.png"},4120:function(t,e,i){t.exports=i.p+"img/tile_6x7_3.b285db6e.png"},"4bb5":function(t,e,i){var n={"./drop_1.png":"539e","./drop_2.png":"73d1","./drop_3.png":"ce51","./drop_4.png":"1635","./drop_5.png":"f6fd","./drop_6.png":"df11","./drop_6_2.png":"37c5","./drop_7.png":"58f5","./drop_8.png":"e232","./drop_9.png":"0e56"};function r(t){var e=a(t);return i(e)}function a(t){var e=n[t];if(!(e+1)){var i=new Error("Cannot find module '"+t+"'");throw i.code="MODULE_NOT_FOUND",i}return e}r.keys=function(){return Object.keys(n)},r.resolve=a,t.exports=r,r.id="4bb5"},"527e":function(t,e,i){"use strict";var n=i("2760"),r=i.n(n);r.a},"539e":function(t,e,i){t.exports=i.p+"img/drop_1.8a3a14fe.png"},"55df":function(t,e,i){},"561e":function(t,e,i){},5629:function(t,e,i){},"56d7":function(t,e,i){"use strict";i.r(e);i("cadf"),i("551c"),i("f751"),i("097d");var n=i("2b0e"),r=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"root"},on:{click:t.focus,contextmenu:function(e){return e.preventDefault(),t.search(e)}}},[i("div",[i("GameArea",{attrs:{board:t.board,boardSize:t.boardSettings.boardSize},on:{shuffle:t.shuffle,search:t.search},model:{value:t.gameApp,callback:function(e){t.gameApp=e},expression:"gameApp"}}),i("RightContainer",{attrs:{board:t.board,maximum:t.maximum,bestNode:t.bestNode,stateFlag:t.stateFlag,searchStatus:t.searchStatus,boardSettings:t.boardSettings,searchSettings:t.searchSettings,clearingSettings:t.clearingSettings},on:{changeBoardSize:function(e){return t.changeBoardSize(e)},changeLeader1:function(e){return t.changeLeader(1,e)},changeLeader2:function(e){return t.changeLeader(2,e)},capture:t.capture,moveDrops:t.moveDrops,search:t.search,captureAndSearch:function(e){t.capture().then(t.search)}}})],1),i("Sounds")],1)},a=[],o=(i("8e6e"),i("456d"),i("c5f6"),i("96cf"),i("3b8d")),s=i("bd86"),c=(i("1c4c"),i("ac6a"),i("5df3"),i("4f7f"),function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("canvas",{attrs:{id:"game-canvas"}})}),u=[],h=i("549d"),d=i("768b");i("386d"),i("ac4d"),i("8a81"),i("f400"),i("28a5");h["globalize"]();var l=h["define"]("ImmovablePosition",{superClass:"Sprite",init:function(t){this.superInit("immovable",t,t)},setAlpha:function(t){return this.alpha=t,this},setItemIndex:function(t){return this._itemIndex=t,this},setScene:function(t){return this._scene=t,this},onpointstart:function(){this._scene.selectItem(this._itemIndex)}});h["globalize"]();var p=h["define"]("MyDisplayElement",{superClass:"phina.display.DisplayElement",init:function(){this.superInit()},setAlpha:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.children.forEach(function(i){i.children.length?"setAlpha"in i&&i.setAlpha(t,e):e?i.tweener.to({alpha:t},e).play():i.alpha=t}),this},hide:function(){return this.children.forEach(function(t){t.hide()}),this},fadeOut:function(t){return this.children.forEach(function(e){e.tweener.fadeOut(t).play()}),this},fadeIn:function(t){return this.children.forEach(function(e){e.tweener.fadeIn(t).play()}),this}});h["globalize"]();var f=h["define"]("Arc",{superClass:"phina.display.Shape",init:function(t,e,i,n,r){this.superInit({width:t,height:t,backgroundColor:"transparent"}),this._startAngle=(0+i)*Math.PI/180,this._endAngle=(90-i)*Math.PI/180,this._radius=e,this._color1=n,this._color2=r},postrender:function(){this._drawArc("round",2,this._color1),this._drawArc("butt",1,this._color2)},_drawArc:function(t,e,i){var n=this.canvas;n.shadowColor="rgb(36,84,145)",n.shadowBlur=3,n.lineCap=t,n.lineWidth=e,n.strokeStyle=i,n.strokeArc(0,0,this._radius,this._startAngle,this._endAngle)}});h["globalize"]();var m=h["define"]("Line",{superClass:"phina.display.Shape",init:function(t,e,i,n,r){this.superInit({width:t,height:t,backgroundColor:"transparent"}),this._y0=e-i/2,this._y1=e+i/2,this._color1=n,this._color2=r},postrender:function(){this._drawLine("round",2,this._color1),this._drawLine("butt",1,this._color2)},_drawLine:function(t,e,i){var n=this.canvas;n.lineCap=t,n.lineWidth=e,n.strokeStyle=i,n.drawLine(0,this._y0,0,this._y1)}});h["globalize"]();var b=h["define"]("Triangle",{superClass:"phina.display.Shape",init:function(t,e,i,n){this.superInit({width:t,height:t,backgroundColor:"transparent"}),h["display"].TriangleShape({fill:n,stroke:i,strokeWidth:1,radius:2}).moveTo(0,e).addChildTo(this)},setAlpha:function(t){this.children[0].alpha=t}}),g=h["define"]("StartPosition",{superClass:"MyDisplayElement",init:function(t){this.superInit(),this.setObjects(t),this.setSize(t,t)},setObjects:function(t){var e="lighter",i="blue",n="#FFFFFF",r=t/2-12,a=20,o=5,s=t/2-4;this.innerGroup=p().addChildTo(this),this.outerGroup=p().addChildTo(this);for(var c=0;c<4;c++)f(t,r,a,i,n).setRotation(90*c).addChildTo(this.innerGroup);for(var u=0;u<4;u++)m(t,r,o,i,n).setRotation(90*u).addChildTo(this.innerGroup);for(var h=0;h<2;h++)b(t,s,n,n).setRotation(180*h).addChildTo(this.innerGroup);for(var d=0;d<2;d++)b(t,s,i,n).setRotation(180*d).addChildTo(this.outerGroup);this.innerGroup.children.each(function(t){return t.blendMode=e}),this.outerGroup.children.each(function(t){return t.blendMode=e})},rotate:function(){var t=this;return this.update=function(){t.innerGroup.rotation+=3,t.outerGroup.rotation-=3},this},setItemIndex:function(t){return this._itemIndex=t,this},setScene:function(t){return this._scene=t,this},onpointstart:function(){this._scene.selectItem(this._itemIndex)}});h["globalize"]();var v=h["define"]("BaseScene",{superClass:"DisplayScene",init:function(t){this.superInit({width:t.width,height:t.height}),this._setAttributes(t),this._setComputedAttributes();var e="tile_".concat(this.boardSize);h["display"].Sprite(e).setOrigin(0,0).addChildTo(this);var i=h["display"].DisplayElement;this.buttonGroup=i().moveTo(0,this.topMargin-136).addChildTo(this),this.dropGroup=i().moveTo(this.leftMargin,this.topMargin).addChildTo(this),this.harassmentGroup=i().moveTo(this.leftMargin,this.topMargin).addChildTo(this)},_setAttributes:function(t){var e=t.boardData,i=t.screenData;this.vueComponent=t.vueComponent,this.boardData=e,this.screenData=i,Object.assign(this,e,i),this.board=Array.from(this.board)},_setComputedAttributes:function(){this.boardHeight=Number(this.boardSize.split("x")[0]),this.boardWidth=Number(this.boardSize.split("x")[1]),this.boardPixelHeight=this.screenPixelHeight-this.topMargin,this.boardPixelWidth=this.screenPixelWidth-(this.leftMargin+this.rightMargin),this.dropSize=this.boardPixelWidth/this.boardWidth,this.dropGridX=h["util"].Grid(this.boardPixelWidth,this.boardWidth),this.dropGridY=h["util"].Grid(this.boardPixelHeight,this.boardHeight)},get1dIndex:function(t,e){return this.boardWidth*e+t},get2dIndex:function(t){var e=t%this.boardWidth,i=Math.floor(t/this.boardWidth);return[e,i]},getCoordinatesOfDrop:function(t,e){if("number"===typeof t&&"number"!==typeof e){var i=t;t=i%this.boardWidth,e=Math.floor(i/this.boardWidth)}var n=this.dropGridX.span(t+.5),r=this.dropGridY.span(e+.5);return[n,r]},getPositionOfDrop:function(t){var e=Math.floor((t.pointer.x-this.leftMargin)/this.dropSize),i=Math.floor((t.pointer.y-this.topMargin)/this.dropSize),n=this.boardWidth*i+e;return[e,i,n]},isInsideOfBoard:function(t,e){return 0<=t&&t<this.boardWidth&&0<=e&&e<this.boardHeight},isOutOfBoard:function(t,e){return t<0||this.boardWidth<=t||e<0||this.boardHeight<=e},initImmovablePositionSprites:function(){this.immovablePositionSprites=new Map;var t=!0,e=!1,i=void 0;try{for(var n,r=this.immovablePositions[Symbol.iterator]();!(t=(n=r.next()).done);t=!0){var a=n.value,o=this.createImmovablePositionSprite(a);this.immovablePositionSprites.set(a,o)}}catch(s){e=!0,i=s}finally{try{t||null==r.return||r.return()}finally{if(e)throw i}}return this},initStartPositionSprite:function(){var t=this.startPosition;-1!==t&&(this.startPositionSprite=this.createStartPositionSprite(t))},createImmovablePositionSprite:function(t){var e=this.getCoordinatesOfDrop(t),i=Object(d["a"])(e,2),n=i[0],r=i[1];return l(this.baseDropSize).moveTo(n,r).setScale(this.dropScale).addChildTo(this.harassmentGroup)},createStartPositionSprite:function(t){var e=this.getCoordinatesOfDrop(t),i=Object(d["a"])(e,2),n=i[0],r=i[1];return g(this.baseDropSize).moveTo(n,r).rotate().setScale(1.3*this.dropScale).addChildTo(this.harassmentGroup)}});h["globalize"]();var S=h["define"]("StylishButton",{superClass:"Button",init:function(t){var e={width:117,height:117,text:t,fill:"rgba(0, 0, 0, 0.1)",stroke:"rgb(0,227,255)",fontColor:"rgb(0,227,255)",fontSize:22};this.superInit(e)}}),_=i("75fc"),y=h["define"]("Drop",{superClass:"Sprite",init:function(t){this.superInit("drops",t,t)},setAlpha:function(t){return this.alpha=t,this}}),C=h["define"]("NormalDrop",{superClass:"Drop",init:function(t){this.superInit(t)},tweenMoveTo:function(t,e){var i=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.destination&&(this.tweener.clear(),this.moveTo.apply(this,Object(_["a"])(this.destination))),"number"===typeof t&&"number"===typeof e&&(this.destination=[t,e],this.tweener.moveTo(t,e,n).play().call(function(){return delete i.destination})),this}}),x=h["define"]("GrabbedDrop",{superClass:"Drop",init:function(t){this.superInit(t)},move:function(t){var e=t.pointer.x,i=t.pointer.y-5;return this.moveTo(e,i),this}}),D=h["define"]("ItemDrop",{superClass:"Drop",init:function(t){this.superInit(t)},setItemIndex:function(t){return this._itemIndex=t,this},setScene:function(t){return this._scene=t,this},onpointstart:function(){this._scene.selectItem(this._itemIndex)}});h["globalize"]();var O=h["define"]("DragonOutline",{superClass:"phina.display.Shape",init:function(t,e){this.superInit({width:e,height:e,padding:1,backgroundColor:"transparent"}),this.dropSize=e,this.lineType=t.lineType,this.moveTo(t.x,t.y)._rotate()},postrender:function(){this._drawOutline(12,12,"rgba(255,215,0,0.7)"),this._drawOutline(8,12,"rgba(255,255,255,0.5)"),this._drawOutline(3,12,"black")},_drawOutline:function(t,e,i){var n=this.canvas,r=-this.dropSize/2,a=-e,o=0,s=e,c=this.dropSize/2;switch(n.shadowColor="rgb(255, 255, 255)",n.shadowBlur=5,n.lineCap="round",n.lineWidth=t,n.strokeStyle=i,this.lineType){case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:n.drawLine(r,a,o,a),n.drawLine(r,s,o,s);break;case 9:case 10:case 11:case 12:n.drawLine(r,a,c,a),n.drawLine(r,s,c,s);break;case 13:case 14:case 15:case 16:case 17:case 18:case 19:case 20:n.moveTo(r,s).quadraticCurveTo(a,s,a,c),n.moveTo(r,a).quadraticCurveTo(s,a,s,c).stroke();break}return this},_rotate:function(){switch(this.lineType){case 2:case 6:case 17:case 18:this.setRotation(180);break;case 3:case 7:case 11:case 12:case 15:case 16:this.setRotation(90);break;case 4:case 8:case 19:case 20:this.setRotation(270);break}return this}});h["globalize"]();var T=h["define"]("DragonBody",{superClass:"phina.display.Shape",init:function(t,e,i){this.superInit({width:e,height:e,padding:1,backgroundColor:"transparent"}),this.lineData=t,this.processLen=i,this.moveTo(t.x,t.y)},postrender:function(){this._drawBody()},_drawBody:function(){var t=this.canvas,e=this.lineData,i=e.lineType,n=e.beginX,r=e.beginY,a=e.endX,o=e.endY;return t.lineCap="round",t.lineJoin="round",t.lineWidth=23,t.strokeStyle=this._getCanvasGradient(),0===i?t.drawLine(n,r,0,0).drawLine(0,0,a,o):t.moveTo(n,r).quadraticCurveTo(0,0,a,o).stroke(),this},_getCanvasGradient:function(){var t=this.lineData,e=t.beginX,i=t.beginY,n=t.endX,r=t.endY,a=t.index,o=this.canvas.context.createLinearGradient(e,i,n,r),s=200-Math.round(220/this.processLen*a)%360,c=200-Math.round(220/this.processLen*(a+1))%360,u=100,h=100,d=50,l=50;return o.addColorStop(0,"hsl(".concat(s,", ").concat(u,"%, ").concat(d,"%)")),o.addColorStop(1,"hsl(".concat(c,", ").concat(h,"%, ").concat(l,"%)")),o}});h["globalize"]();var A=h["define"]("DragonScale",{superClass:"phina.display.Shape",init:function(t,e){this.superInit({width:e,height:e,padding:1,backgroundColor:"transparent"}),this.moveTo(t.x,t.y)._rotate(t,e)},postrender:function(){this._drawScale()},_drawScale:function(){var t=this.canvas,e=13,i=13,n=3;t.lineCap="butt",t.lineJoin="miter",t.lineWidth=1.5,t.strokeStyle="#000",t.moveTo(0,i).quadraticCurveTo(0,n,-e,-i).stroke(),t.moveTo(0,i).quadraticCurveTo(0,n,e,-i).stroke()},_rotate:function(t,e){var i=.135*e;switch(t.lineType){case 2:case 5:case 9:this.setRotation(90);break;case 1:case 6:case 10:this.setRotation(-90);break;case 4:case 7:case 11:this.setRotation(180);break;case 13:this.moveBy(-i,i),this.setRotation(135);break;case 14:this.moveBy(-i,i),this.scaleX=-1,this.setRotation(-45);break;case 15:this.moveBy(-i,-i),this.setRotation(225);break;case 16:this.moveBy(-i,-i),this.setRotation(45);break;case 17:this.moveBy(i,-i),this.setRotation(-45);break;case 18:this.moveBy(i,-i),this.setRotation(135);break;case 19:this.moveBy(i,i),this.setRotation(45);break;case 20:this.moveBy(i,i),this.setRotation(225);break}}});h["globalize"]();var w=h["define"]("DragonTail",{superClass:"Sprite",init:function(t,e){var i=600,n=e/i*1.3;this.superInit("dragon_tail",i,i),this.setScale(n)._move(t)},_move:function(t){var e=t.x,i=t.y,n=t.lineType;switch(this.moveTo(e,i),n){case 1:this.setRotation(-90);break;case 2:this.setRotation(90);break;case 4:this.setRotation(180);break}return this}});h["globalize"]();var k=h["define"]("DragonHead",{superClass:"Sprite",init:function(t,e){var i=1e3,n=e/i*1.5;this.superInit("dragon_head",i,i),this.setScale(n)._move(t)},_move:function(t){var e=t.x,i=t.y,n=t.lineType;switch(this.moveTo(e,i),n){case 6:this.scaleX*=-1;break;case 8:this.setRotation(-90);break}return this}});h["globalize"]();var I=h["define"]("Dragon",{superClass:p,init:function(t,e,i){var n=this;this.superInit();var r=this._getLineData(t,e,i);r.forEach(function(t,r){O(t,i).addChildTo(n),T(t,i,e.length).addChildTo(n),A(t,i).addChildTo(n),0===r?w(t,i).addChildTo(n):n._isLast(r,e)&&k(t,i).addChildTo(n)})},_isLast:function(t,e){return t===e.length-1},_getLineData:function(t,e,i){var n=this;return e.map(function(r,a){var o=r%t,s=Math.floor(r/t),c=i*(o+.5),u=i*(s+.5),h=n._getLineType(t,e,a),l=n._getCoordinates(h,i),p=Object(d["a"])(l,4),f=p[0],m=p[1],b=p[2],g=p[3];return{index:a,lineType:h,beginX:f,beginY:m,endX:b,endY:g,x:c,y:u}})},_getLineType:function(t,e,i){var n=t;if(0===i){var r=e[i]-e[i+1];if(1===r)return 1;if(-1===r)return 2;if(r===n)return 3;if(r===-n)return 4}else if(this._isLast(i,e)){var a=e[i]-e[i-1];if(1===a)return 5;if(-1===a)return 6;if(a===n)return 7;if(a===-n)return 8}else{var o=e[i]-e[i-1],s=e[i]-e[i+1];if(1===o&&-1===s)return 9;if(-1===o&&1===s)return 10;if(o===n&&s===-n)return 11;if(o===-n&&s===n)return 12;if(1===o&&s===-n)return 13;if(o===-n&&1===s)return 14;if(o===n&&1===s)return 15;if(1===o&&s===n)return 16;if(-1===o&&s===n)return 17;if(o===n&&-1===s)return 18;if(o===-n&&-1===s)return 19;if(-1===o&&s===-n)return 20}return 0},_getCoordinates:function(t,e){var i=e/2;switch(t){case 1:return[0,0,-i,0];case 2:return[0,0,i,0];case 3:return[0,0,0,-i];case 4:return[0,0,0,i];case 5:return[-i,0,0,0];case 6:return[i,0,0,0];case 7:return[0,-i,0,0];case 8:return[0,i,0,0];case 9:return[-i,0,i,0];case 10:return[i,0,-i,0];case 11:return[0,-i,0,i];case 12:return[0,i,0,-i];case 13:return[-i,0,0,i];case 14:return[0,i,-i,0];case 15:return[0,-i,-i,0];case 16:return[-i,0,0,-i];case 17:return[i,0,0,-i];case 18:return[0,-i,i,0];case 19:return[0,i,i,0];case 20:return[i,0,0,i];default:return[0,0,0,0]}}});h["globalize"]();var E=h["define"]("MoveCountLabel",{superClass:"phina.display.Label",init:function(){this.superInit({text:"",fontSize:70,fontFamily:"'ＭＳ 明朝', 'ＭＳ ゴシック', 'Times New Roman', serif, sans-serif",fontStyle:"italic",fill:"white",stroke:"white",strokeWidth:0,shadow:"gold",shadowBlur:5}),this.movedCount=0},increment:function(){this.movedCount++,this.text=this.movedCount},reset:function(){this.movedCount=0,this.text=""}}),P=function(){h["define"]("MainScene",{superClass:v,init:function(t){var e=this;this.superInit(t),this._initFlags(),this._setButtons(),this._addEventToButtons(),this._setDrops(),this._setMoveCountLabel(),this.initImmovablePositionSprites(),this.initStartPositionSprite(),t.process&&(this.summonDragon(t.process),t.moveFlag&&setTimeout(function(){e._moveDrops(t.moveTime)},t.moveDuration))},_initFlags:function(){this.dragOkFlag=!0,this.changeFlag=!1,this.lineFlag=!0},_setButtons:function(){var t=this,e=["INPUT","RESET","SHUFFLE","SEARCH","MOVE","DRAGON"],i=h["util"].Grid(this.screenPixelWidth,e.length);e.forEach(function(e,n){var r=i.span(n)-4;S(e).setOrigin(0,0).moveTo(r,0).addChildTo(t.buttonGroup)})},_addEventToButtons:function(){var t=this;this.buttonGroup.children[0].addEventListener("pointstart",function(){t._exitTo("input")}),this.buttonGroup.children[1].addEventListener("pointstart",function(){t._exitTo("main")}),this.buttonGroup.children[2].addEventListener("pointstart",function(){t.vueComponent.shuffle()}),this.buttonGroup.children[3].addEventListener("pointstart",function(){t.vueComponent.search()}),this.buttonGroup.children[4].addEventListener("pointstart",function(){t.moveDrops(120)}),this.buttonGroup.children[5].addEventListener("pointstart",function(){t.dragon&&(t.lineFlag?t.dragon.fadeOut(200):t.dragon.fadeIn(200),t.lineFlag=!t.lineFlag)})},_setDrops:function(){var t=this;this.board.forEach(function(e,i){var n=t.getCoordinatesOfDrop(i),r=Object(d["a"])(n,2),a=r[0],o=r[1];C(t.baseDropSize).setFrameIndex(e).setScale(t.dropScale).moveTo(a,o).addChildTo(t.dropGroup)})},_setMoveCountLabel:function(){var t=this.screenPixelWidth-65,e=this.topMargin-185;this.moveCountLabel=E().moveTo(t,e).addChildTo(this)},_exitTo:function(t){this.exit(t,{boardData:this.boardData,screenData:this.screenData,process:this.process})},onpointstart:function(t){if(this.dragOkFlag){var e=this.getPositionOfDrop(t),i=Object(d["a"])(e,3),n=i[0],r=i[1],a=i[2];if(!this.isOutOfBoard(n,r)){var o=this.board[a];this.dragStartIndex=a,this.dragStartDrop=this.dropGroup.children[a].setAlpha(.3),this.grabbedDrop=x(this.baseDropSize).setFrameIndex(o).setScale(1.1*this.dropScale).setAlpha(.7).move(t).addChildTo(this),this.dragon&&this.lineFlag&&this.dragon.setAlpha(.7,300)}}},onpointmove:function(t){if(this.dragOkFlag){var e=this.getPositionOfDrop(t),i=Object(d["a"])(e,3),n=i[0],r=i[1],a=i[2];this.isOutOfBoard(n,r)||(this.grabbedDrop.move(t),this.dragStartIndex!==a&&(this._swapDrops(this.dragStartIndex,a,!0),this.changeFlag=!0,this.dragStartIndex=a,this.moveCountLabel.increment()))}},onpointend:function(){this.dragOkFlag&&(this.dragStartDrop&&(this.dragStartDrop.setAlpha(1),this.grabbedDrop.remove(),delete this.dragStartDrop,delete this.grabbedDrop),this.changeFlag?(this._finishMoveAnimation(),this._clearDrops(),this.dragon&&this.dragon.hide()):this.dragon&&this.lineFlag&&this.dragon.fadeIn(300))},_swapDrops:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=this.dropGroup.children;if(i){var r=this.getCoordinatesOfDrop(t),a=Object(d["a"])(r,2),o=a[0],s=a[1],c=this.getCoordinatesOfDrop(e),u=Object(d["a"])(c,2),h=u[0],l=u[1];this._finishMoveAnimation(),n[t].tweenMoveTo(h,l,50),n[e].tweenMoveTo(o,s,50)}n.swap(t,e),this.board.swap(t,e)},_finishMoveAnimation:function(){this.dropGroup.children.forEach(function(t){return t.tweenMoveTo()})},_clearDrops:function(){var t=250,e=250,i=50,n=this._getClearablePlacesAsArray(this.board);if(n.length){this.dragOkFlag=!1;for(var r=0;r<n.length;r++)for(var a=0;a<n[r].length;a++){var o=n[r][a],s=this.dropGroup.children[o],c=(t+e)*r;this.board[o]=0,s.tweener.wait(c).fadeOut(t).play()}var u=n.length,h=t*u+e*(u-1)+i;this.tweener.wait(h).call(this._dropDrops.bind(this)).play()}},_dropDrops:function(){for(var t=270,e=80,i=0;i<this.boardWidth;i++)for(var n=this.boardHeight-1;0<n;n--){var r=this.get1dIndex(i,n);if(0===this.board[r])for(var a=1;a<=n;a++){var o=r-this.boardWidth*a;if(0!==this.board[o]){var s=this.dropGroup.children[o],c=this.getCoordinatesOfDrop(i,n),u=Object(d["a"])(c,2),h=u[0],l=u[1];s.tweener.moveTo(h,l,t).play(),this._swapDrops(r,o);break}}}this.tweener.wait(t+e).call(this._clearDrops.bind(this)).play()},_getClearablePlacesAsArray:function(t){for(var e=Array.from(t),i=[],n=new Set,r=0,a=this._getClearablePlacesAsSet(e),o=this.boardHeight;o--;)for(var s=0;s<this.boardWidth;s++){var c=this.get1dIndex(s,o);if(a.has(c)&&!n.has(c)){var u=e[c],h=i[r]=[];this._pushClearablePlaces(e,c,u,a,h,n),r++}}return i},_getClearablePlacesAsSet:function(t){for(var e=new Set,i=0;i<this.boardHeight;i++)for(var n=0;n<this.boardWidth-2;n++){var r=this.get1dIndex(n,i),a=r+1,o=a+1;this._checkWhetherClearablePlaces(t,r,a,o,e)}for(var s=0;s<this.boardWidth;s++)for(var c=0;c<this.boardHeight-2;c++){var u=this.get1dIndex(s,c),h=u+this.boardWidth,d=h+this.boardWidth;this._checkWhetherClearablePlaces(t,u,h,d,e)}return e},_checkWhetherClearablePlaces:function(t,e,i,n,r){0!==t[e]&&t[e]===t[i]&&t[i]===t[n]&&(r.add(e),r.add(i),r.add(n))},_pushClearablePlaces:function(t,e,i,n,r,a){var o=[{X:0,Y:-1},{X:0,Y:1},{X:-1,Y:0},{X:1,Y:0}],s=this.get2dIndex(e),c=Object(d["a"])(s,2),u=c[0],h=c[1];r.push(e),a.add(e);for(var l=0,p=o.length;l<p;l++){var f=u+o[l].X,m=h+o[l].Y,b=this.get1dIndex(f,m);this.isInsideOfBoard(f,m)&&n.has(b)&&t[b]===i&&!a.has(b)&&this._pushClearablePlaces(t,b,i,n,r,a)}},summonDragon:function(t){this.process=t,this.dragon=I(this.boardWidth,t,this.dropSize).moveTo(this.leftMargin,this.topMargin).addChildTo(this)},moveDrops:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.process&&this.exit("main",{boardData:this.boardData,screenData:this.screenData,process:this.process,moveFlag:!0,moveTime:t,moveDuration:e})},_moveDrops:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(0===i){var n=this.process[0];this.dropGroup.children[n].setAlpha(.5),this.dragOkFlag=!1}else if(i===this.process.length-1){var r=this.process.slice(-1)[0];return this.dropGroup.children[r].setAlpha(1),this.dragOkFlag=!0,void(this.changeFlag=!0)}var a=this.process[i],o=this.process[i+1],s=this.dropGroup.children[a],c=this.dropGroup.children[o],u=[s.x,s.y],h=u[0],d=u[1],l=[c.x,c.y],p=l[0],f=l[1];s.tweener.moveTo(p,f,t).call(function(){e._swapDrops(a,o),e._moveDrops(t,i+1)}).play(),c.tweener.wait(t/2).call(function(){c.moveTo(h,d)}).play()}})},N=9,M=6,L=1.9,j=1,G=.4,R=function(){h["define"]("InputScene",{superClass:v,init:function(t){this.superInit(t);var e=65,i=this.topMargin-71;this.itemGroup=h["display"].DisplayElement().moveTo(e,i).addChildTo(this),this._initItems()._initStartButton()._initDrops().initImmovablePositionSprites().initStartPositionSprite()},selectItem:function(t){this._selectedItem=t,this.itemGroup.children.forEach(function(e,i){i+1===t?e.setAlpha(j):e.setAlpha(G)})},_initItems:function(){for(var t=this,e=1;e<=N;e++)D(this.baseDropSize).setFrameIndex(e).addChildTo(this.itemGroup);return l(this.baseDropSize).addChildTo(this.itemGroup),g(this.baseDropSize).addChildTo(this.itemGroup),this.itemGroup.children.forEach(function(e,i){var n=t._getCoordinatesOfItem(i),r=Object(d["a"])(n,2),a=r[0],o=r[1];e.setScene(t).setItemIndex(i+1).setInteractive(!0).moveTo(a,o).setScale(L).setAlpha(G)}),this},_getCoordinatesOfItem:function(t){var e=this.baseDropSize*L,i=e*(t%M),n=-e*Math.floor(t/M);return[i,n]},_initStartButton:function(){var t=this,e=this.screenPixelWidth-129;return S("START").setOrigin(0,0).moveTo(e,0).addChildTo(this.buttonGroup).addEventListener("pointstart",function(){t.boardData.board=t.board,t.boardData.startPosition=t.startPosition,t.exit({boardData:t.boardData,screenData:t.screenData})}),this},_initDrops:function(){var t=this;return this.board.forEach(function(e,i){var n=t.getCoordinatesOfDrop(i),r=Object(d["a"])(n,2),a=r[0],o=r[1];y(t.baseDropSize).setFrameIndex(e).setScale(t.dropScale).moveTo(a,o).addChildTo(t.dropGroup)}),this},onpointstart:function(t){void 0!==this._selectedItem&&this._applyChange.apply(this,Object(_["a"])(this.getPositionOfDrop(t)))},onpointmove:function(t){void 0!==this._selectedItem&&this._applyChange.apply(this,Object(_["a"])(this.getPositionOfDrop(t)))},onpointend:function(){delete this._lastMoveIndex},_applyChange:function(t,e,i){if(!this.isOutOfBoard(t,e)&&this._lastMoveIndex!==i)switch(this._lastMoveIndex=i,this._selectedItem){case N+1:this._updateImmovablePosition(i);break;case N+2:this._updateStartPosition(i);break;default:this._updateDrop(i)}},_updateImmovablePosition:function(t){if(this.startPosition!==t)if(this.immovablePositions.has(t))this.immovablePositions.delete(t),this.immovablePositionSprites.get(t).remove();else{this.immovablePositions.add(t);var e=this.createImmovablePositionSprite(t);this.immovablePositionSprites.set(t,e)}},_updateStartPosition:function(t){if(!this.immovablePositions.has(t))if(-1===this.startPosition)this.startPosition=t,this.startPositionSprite=this.createStartPositionSprite(t);else if(this.startPosition===t)this.startPosition=null,this.startPositionSprite.remove();else{this.startPosition=t;var e=this.getCoordinatesOfDrop(t),i=Object(d["a"])(e,2),n=i[0],r=i[1];this.startPositionSprite.moveTo(n,r)}},_updateDrop:function(t){var e=this._selectedItem;this.board[t]=e,this.dropGroup.children[t].setFrameIndex(e)}})},B={image:{drops:i("0e59"),tile_5x6:i("e4cb"),tile_6x7:i("4120"),immovable:i("a1c7"),dragon_head:i("dd21"),dragon_tail:i("de0b")}},$=[{label:"main",className:"MainScene"},{label:"input",className:"InputScene",nextLabel:"main"}],z=1334,F=750,W=53,H={"5x6":2.32,"6x7":1.92},Y={"5x6":718,"6x7":719},X={"5x6":5,"6x7":17},U={"5x6":6,"6x7":19},K=h["define"]("MyGameApp",{superClass:"phina.game.GameApp",init:function(t){t=(t||{}).$safe({startLabel:"main",assets:B,scenes:$,width:F,height:z,boardData:this._getBoardData(t.gameData),screenData:this._getScreenData(t.gameData),vueComponent:t.gameData.vueComponent}),this.superInit(t)},displayLine:function(t){var e=this.currentScene;return"summonDragon"in e&&e.summonDragon(t),this},moveDrops:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:120,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=this.currentScene;return"moveDrops"in i&&i.moveDrops(t,e),this},startNewGame:function(t){var e=this.currentScene;return e.exit("main",{boardData:this._getBoardData(t),screenData:this._getScreenData(t)}),this},_getBoardData:function(t){var e=t.board,i=t.boardSize,n=t.startPosition,r=t.immovablePositions;return void 0===n&&(n=-1),r=void 0===r?new Set:new Set(r),{board:Array.from(e),boardSize:i,startPosition:n,immovablePositions:r}},_getScreenData:function(t){var e=t.boardSize;return{screenPixelHeight:z,screenPixelWidth:F,baseDropSize:W,dropScale:H[e],topMargin:Y[e],leftMargin:X[e],rightMargin:U[e]}}});function q(t){return new Promise(function(e){P(),R(),h["main"](function(){var i=K({query:"#game-canvas",fit:!1,gameData:t});i.run(),e(i)})})}Array.prototype.swap=function(t,e){var i=[this[e],this[t]];this[t]=i[0],this[e]=i[1]};var J=q,V={name:"GameArea",props:{board:Array,boardSize:String,gameApp:Object},computed:{gameData:function(){return{board:this.board,boardSize:this.boardSize,vueComponent:this}}},created:function(){var t=this;J(this.gameData).then(function(e){return t.$emit("input",e)}).catch(function(t){return console.error(t)})},methods:{shuffle:function(){this.$emit("shuffle")},search:function(){this.$emit("search")}}},Z=V,Q=(i("9530"),i("2877")),tt=Object(Q["a"])(Z,c,u,!1,null,"5755fd96",null),et=tt.exports,it=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"right-container"}},[i("KeyInput",{on:{capture:function(e){return t.$emit("capture")},moveDrops:function(e){return t.$emit("moveDrops")},search:function(e){return t.$emit("search")},captureAndSearch:function(e){return t.$emit("captureAndSearch")}}}),i("Information",{attrs:{searchStatus:t.searchStatus,stateFlag:t.stateFlag,bestNode:t.bestNode,maximum:t.maximum,dropTypesWithIndex:t.dropTypesWithIndex}}),i("ControlPanel",{attrs:{maxCombo:t.maximum.combo,boardSettings:t.boardSettings,searchSettings:t.searchSettings,clearingSettings:t.clearingSettings},on:{changeLeader1:function(e){return t.$emit("changeLeader1",e)},changeLeader2:function(e){return t.$emit("changeLeader2",e)},changeBoardSize:function(e){return t.$emit("changeBoardSize",e)}}})],1)},nt=[],rt=(i("6c7b"),function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("input",{directives:[{name:"focus",rawName:"v-focus"}],attrs:{id:"key-input"},on:{keyup:[function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"left",37,e.key,["Left","ArrowLeft"])?null:"button"in e&&0!==e.button?null:t.$emit("capture")},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"up",38,e.key,["Up","ArrowUp"])?null:t.$emit("moveDrops")},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"down",40,e.key,["Down","ArrowDown"])?null:t.$emit("search")},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"right",39,e.key,["Right","ArrowRight"])?null:"button"in e&&2!==e.button?null:t.$emit("captureAndSearch")}]}})}),at=[],ot={name:"KeyInput",directives:{focus:{inserted:function(t){t.focus()}}}},st=ot,ct=(i("804c"),Object(Q["a"])(st,rt,at,!1,null,"8e7be10c",null)),ut=ct.exports,ht=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("fieldset",{attrs:{id:"information"}},[i("div",[i("State",{attrs:{stateFlag:t.stateFlag}}),i("SearchData",{attrs:{stateFlag:t.stateFlag,bestNode:t.bestNode,searchStatus:t.searchStatus}})],1),i("ComboData",{attrs:{comboData:t.comboData,maximum:t.maximum,dropTypesWithIndex:t.dropTypesWithIndex}})],1),t._m(0)])},dt=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"information-bar"}},[i("div")])}],lt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("fieldset",{attrs:{id:"state"}},[i("div",[t.stateFlag===this.$STATE.STANDBY?i("p",[t._v("STANDBY")]):t.stateFlag===this.$STATE.SEARCHING?i("p",[t._v("SEARCHING...")]):t.stateFlag===this.$STATE.SEARCH_END?i("p",[t._v("SEARCH END")]):t._e()])])},pt=[],ft={name:"State",props:{stateFlag:Number}},mt=ft,bt=(i("527e"),Object(Q["a"])(mt,lt,pt,!1,null,"69c89a78",null)),gt=bt.exports,vt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("fieldset",{attrs:{id:"search-data"}},[t.stateFlag===this.$STATE.SEARCH_END?i("table",[i("tr",[i("th",[t._v("TIME")]),i("td",[t._v(t._s(t.elapsedTime)+" sec")])]),i("tr",[i("th",[t._v("MOVE")]),i("td",[t._v(t._s(t.movedCount))])]),i("tr",[i("th",[t._v("STATUS")]),i("td",{class:t.statusClass},[t._v(t._s(t.searchStatus))])])]):t._e()])},St=[],_t={name:"SearchData",props:{stateFlag:Number,bestNode:Object,searchStatus:String},computed:{elapsedTime:function(){return this.bestNode?this.bestNode.elapsedTime:0},movedCount:function(){return this.bestNode?this.bestNode.movedCount:0},statusClass:function(){return{ok:"OK"===this.searchStatus,danger:"DANGER"===this.searchStatus}}}},yt=_t,Ct=(i("cc8f"),Object(Q["a"])(yt,vt,St,!1,null,"751a379a",null)),xt=Ct.exports,Dt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("fieldset",{attrs:{id:"combo-data"}},[i("table",[i("tr",[i("td",[t._v("Max")]),i("td",{staticClass:"combo"},[t._v(t._s(t.maximum.combo)+"combo")]),i("td",{staticClass:"magni"},[t._v("×"+t._s(t.maxMagnificationDisplay))]),i("td",{on:{click:function(e){t.displayInfoFlag=!t.displayInfoFlag}}},[t.displayInfoFlag?i("DropData",{attrs:{drops:t.clearableDrops,property1:"maxCombo",property2:"maxComboCount"}}):i("DropData",{attrs:{drops:t.existingDrops,property1:"count",property2:"count"}})],1)]),i("tr",[t.comboData?[i("td"),i("td",{staticClass:"combo",class:t.maximumClass.combo},[t._v(t._s(t.comboData.combo)+"combo")]),i("td",{staticClass:"magni",class:t.maximumClass.magni},[t._v("×"+t._s(t.magnificationDisplay))]),i("td",{on:{click:function(e){t.displayInfoFlag=!t.displayInfoFlag}}},[t.displayInfoFlag?i("DropData",{attrs:{drops:t.clearableDrops,property1:"maxCombo",property2:"comboCount"}}):i("DropData",{attrs:{drops:t.existingDrops,property1:"count",property2:"clearCount"}})],1)]:t._e()],2)])])},Ot=[],Tt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",t._l(t.drops,function(e){return i("div",{key:e.index,class:{many:e[t.property1]>=10}},[e[t.property2]?[i("img",{attrs:{src:e.imgSrc}}),e[t.property2]>=2?i("span",[t._v(t._s(e[t.property2]))]):t._e()]:t._e()],2)}),0)},At=[],wt={name:"DropData",props:{drops:Array,property1:String,property2:String}},kt=wt,It=(i("c3b5"),Object(Q["a"])(kt,Tt,At,!1,null,"3d5c397c",null)),Et=It.exports,Pt={name:"ComboData",props:{maximum:Object,comboData:Object,dropTypesWithIndex:Array},components:{DropData:Et},data:function(){return{displayInfoFlag:!0}},computed:{maxMagnificationDisplay:function(){return this.adjust(this.maximum.magnification)},magnificationDisplay:function(){return this.adjust(this.comboData.magnification)},existingDrops:function(){return this.dropTypesWithIndex.filter(function(t){return t.count})},clearableDrops:function(){return this.dropTypesWithIndex.filter(function(t){return t.maxComboCount})},maximumClass:function(){return{combo:{maximum:this.maximum.combo===this.comboData.combo},magni:{maximum:this.maximum.magnification===this.comboData.magnification}}}},methods:{adjust:function(t){return t>=100&&(t=Math.round(t)),t.toLocaleString()}}},Nt=Pt,Mt=(i("63c0"),Object(Q["a"])(Nt,Dt,Ot,!1,null,"487b6a5a",null)),Lt=Mt.exports,jt={name:"Information",props:{searchStatus:String,stateFlag:Number,bestNode:Object,maximum:Object,dropTypesWithIndex:Array},components:{State:gt,SearchData:xt,ComboData:Lt},computed:{comboData:function(){return this.bestNode?this.bestNode.comboData:null}}},Gt=jt,Rt=(i("e9bc"),Object(Q["a"])(Gt,ht,dt,!1,null,null,null)),Bt=Rt.exports,$t=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("fieldset",{attrs:{id:"control-panel"}},[i("SkillButtons"),i("BoardSettings",{attrs:{boardSettings:t.boardSettings},on:{changeLeader1:function(e){return t.$emit("changeLeader1",e)},changeLeader2:function(e){return t.$emit("changeLeader2",e)},changeBoardSize:function(e){return t.$emit("changeBoardSize",e)}}}),i("SearchSettings",{attrs:{maxCombo:t.maxCombo,searchSettings:t.searchSettings}}),i("ClearingSettings",{attrs:{clearingSettings:t.clearingSettings}})],1)},zt=[],Ft=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"skill-buttons"}},t._l(t.skills,function(e,n,r){return i("SkillButton",{key:r,attrs:{skill:e}},[t._v(t._s(n))])}),1)},Wt=[],Ht=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("button",{class:{active:t.active},on:{click:t.commonProcessing,contextmenu:function(e){return e.stopPropagation(),e.preventDefault(),t.commonProcessing(e)}}},[t._t("default")],2)},Yt=[],Xt={name:"SkillButton",props:{skill:Object},data:function(){return{active:!1}},methods:{commonProcessing:function(t){if(!this.active)switch(this.activate(),this.skill.hasOwnProperty("common")&&this.skill.common.bind(this)(t),t.type){case"click":this.clickLeftProcessing(t);break;case"contextmenu":this.clickRightProcessing(t);break}},clickLeftProcessing:function(t){this.skill.left.bind(this)(t)},clickRightProcessing:function(t){this.skill.hasOwnProperty("right")?this.skill.right.bind(this)(t):this.skill.left.bind(this)(t)},activate:function(){this.active=!0,this.$playSound("sound-button"),setTimeout(this.deactivate,500)},deactivate:function(){this.active=!1}}},Ut=Xt,Kt=(i("5790"),Object(Q["a"])(Ut,Ht,Yt,!1,null,"1e49587b",null)),qt=Kt.exports,Jt={name:"SkillButtons",components:{SkillButton:qt},data:function(){return{skills:{COCO:{common:function(){},left:function(){},right:function(){}},MUT:{common:function(){},left:function(){},right:function(){}},"KOMASAN-S":{common:function(){},left:function(){},right:function(){}},EIR:{common:function(){},left:function(){},right:function(){}},LUCIFER:{common:function(){},left:function(){},right:function(){}},CAPTURE:{left:function(){},right:function(){}}}}}},Vt=Jt,Zt=(i("dc99"),Object(Q["a"])(Vt,Ft,Wt,!1,null,"a0296c16",null)),Qt=Zt.exports,te=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("fieldset",{attrs:{id:"board-settings"}},[i("legend",[t._v("BOARD SETTINGS")]),i("div",[i("label",[t._v("BOARD"),i("BoardSizeInput",{attrs:{value:"5x6",boardSize:t.boardSize},on:{change:function(e){return t.$emit("changeBoardSize",e)}}}),i("BoardSizeInput",{attrs:{value:"6x7",boardSize:t.boardSize},on:{change:function(e){return t.$emit("changeBoardSize",e)}}})],1),i("label",[t._v("LEADER"),i("select",{domProps:{value:t.leader1},on:{change:function(e){t.$emit("changeLeader1",Number(e.target.value))}}},t._l(t.leaderLabels,function(e,n){return i("option",{key:n,domProps:{value:n}},[t._v(t._s(e))])}),0),i("select",{domProps:{value:t.leader2},on:{change:function(e){t.$emit("changeLeader2",Number(e.target.value))}}},t._l(t.leaderLabels,function(e,n){return i("option",{key:n,domProps:{value:n}},[t._v(t._s(e))])}),0)])])])},ee=[],ie=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("label",{class:{checked:t.selected}},[i("input",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{type:"radio"},domProps:{value:t.value,checked:t.selected},on:{change:function(e){return t.$emit("change",e.target.value)}}}),t._v("\n  "+t._s(t.value)+"\n")])},ne=[],re={name:"BoardSizeInput",props:{value:String,boardSize:String},computed:{selected:function(){return this.value===this.boardSize}}},ae=re,oe=(i("03a7"),Object(Q["a"])(ae,ie,ne,!1,null,"50c35a3a",null)),se=oe.exports,ce={name:"BoardSettings",props:{boardSettings:Object},components:{BoardSizeInput:se},data:function(){return{leaderLabels:["METATRON","KOMA-S","AMEN","HYLEN","COCO","VEROAH","BARJULY"]}},computed:{boardSize:function(){return this.boardSettings.boardSize},leader1:function(){return this.boardSettings.leader1},leader2:function(){return this.boardSettings.leader2}}},ue=ce,he=(i("dedb"),Object(Q["a"])(ue,te,ee,!1,null,"2b0710a2",null)),de=he.exports,le=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("fieldset",{attrs:{id:"search-settings"}},[i("legend",[t._v("SEARCH SETTINGS")]),i("div",t._l(t.searchSettings,function(e,n,r){return i("search-setting",{key:r,attrs:{label:n,setting:e,maxCombo:t.maxCombo}})}),1)])},pe=[],fe=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("label",{on:{wheel:t.changeNumber}},[t._v("\n  "+t._s(t.upperCamelCaseLabel)+"\n  "),i("input",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"},{name:"model",rawName:"v-model.number",value:t.setting.value,expression:"setting.value",modifiers:{number:!0}}],attrs:{type:"number",min:t.setting.min,max:t.max,step:t.setting.step},domProps:{value:t.setting.value},on:{input:function(e){e.target.composing||t.$set(t.setting,"value",t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}}),i("span",{staticClass:"checked"},[t._v(t._s(t.numberToDisplay))])])},me=[],be=(i("4917"),{computed:{upperCamelCaseLabel:function(){var t=this.label.match(/[A-Z]/);if(t&&0!=t.index){var e=this.label.split("");return e.splice(t.index,0," "),e.join("").toUpperCase()}return this.label.toUpperCase()}}}),ge=i("cffa"),ve={name:"SearchSetting",props:{label:String,setting:Object,maxCombo:Number},mixins:[be],data:function(){return{tweenedNumber:this.setting.value}},computed:{max:function(){return this.setting.hasOwnProperty("max")?this.setting.max:this.maxCombo},numberToDisplay:function(){return 1===this.setting.step?this.setting.value:this.animatedNumber},animatedNumber:function(){return this.tweenedNumber.toFixed(0)}},watch:{"setting.value":function(t){ge["a"].to(this.$data,.25,{tweenedNumber:t})}},methods:{changeNumber:function(){var t=parseFloat(this.setting.step),e=parseFloat(this.setting.min),i=parseFloat(this.max);event.deltaY<0?this.setting.value+t<=i&&(this.setting.value+=t):this.setting.value-t>=e&&(this.setting.value-=t)}}},Se=ve,_e=(i("8603"),Object(Q["a"])(Se,fe,me,!1,null,"5b95236e",null)),ye=_e.exports,Ce={name:"SearchSettings",components:{SearchSetting:ye},props:{maxCombo:Number,searchSettings:Object}},xe=Ce,De=(i("30ab"),Object(Q["a"])(xe,le,pe,!1,null,null,null)),Oe=De.exports,Te=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("fieldset",{attrs:{id:"clearing-settings"}},[i("legend",[t._v("CLEARING SETTINGS")]),i("table",t._l(t.clearingSettings,function(t,e,n){return i("ClearingSetting",{key:n,attrs:{data:t,label:e}})}),1)])},Ae=[],we=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("tr",[i("th",{class:{checked:!t.data[0]}},[t._v(t._s(t.upperCamelCaseLabel))]),i("td",t._l(t.data,function(e,n){return i("label",{key:n,class:{checked:e&&n}},[i("input",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"},{name:"model",rawName:"v-model",value:t.data[n],expression:"data[index]"}],attrs:{type:"checkbox",disabled:e&&!n},domProps:{checked:Array.isArray(t.data[n])?t._i(t.data[n],null)>-1:t.data[n]},on:{change:[function(e){var i=t.data[n],r=e.target,a=!!r.checked;if(Array.isArray(i)){var o=null,s=t._i(i,o);r.checked?s<0&&t.$set(t.data,n,i.concat([o])):s>-1&&t.$set(t.data,n,i.slice(0,s).concat(i.slice(s+1)))}else t.$set(t.data,n,a)},function(e){return t.changeCheckbox(n)}]}}),n?i("img",{staticClass:"drop",attrs:{src:t.getImgSrc(n)}}):i("span",[t._v("NONE")])])}),0)])},ke=[],Ie=(i("7514"),{name:"ClearingSetting",props:{data:Array,label:String},mixins:[be],methods:{changeCheckbox:function(t){var e=this;t?this.data.splice(0,1,!this.data.slice(1).find(function(t){return t})):setTimeout(function(){e.data.forEach(function(t,i){e.data.splice(i,1,!i)})},0),t&&this.data[t]?this.$playSound("sound-on"):this.$playSound("sound-off")},getImgSrc:function(t){return"line"===this.label&&7===t?i("37c5"):i("4bb5")("./drop_".concat(t,".png"))}}}),Ee=Ie,Pe=(i("7293"),Object(Q["a"])(Ee,we,ke,!1,null,null,null)),Ne=Pe.exports,Me={name:"ClearingSettings",components:{ClearingSetting:Ne},props:{clearingSettings:Object}},Le=Me,je=(i("0b9e"),Object(Q["a"])(Le,Te,Ae,!1,null,null,null)),Ge=je.exports,Re={name:"ControlPanel",props:{maxCombo:Number,boardSettings:Object,searchSettings:Object,clearingSettings:Object},components:{SkillButtons:Qt,BoardSettings:de,SearchSettings:Oe,ClearingSettings:Ge},computed:{}},Be=Re,$e=(i("1c2a"),Object(Q["a"])(Be,$t,zt,!1,null,null,null)),ze=$e.exports,Fe={name:"RightContainer",props:{board:Array,maximum:Object,bestNode:Object,stateFlag:Number,searchStatus:String,boardSettings:Object,searchSettings:Object,clearingSettings:Object},components:{KeyInput:ut,Information:Bt,ControlPanel:ze},computed:{dropCountArray:function(){var t=new Array(this.$DROP_TYPE_MAX+1).fill(0);return this.board.forEach(function(e){return t[e]++}),t},comboCountArray:function(){return this.dropCountArray.map(function(t){return Math.floor(t/3)})},dropTypesWithIndex:function(){var t=this;return new Array(this.$DROP_TYPE_MAX).fill(0).map(function(e,n){var r=n+1;return{index:r,imgSrc:i("4bb5")("./drop_".concat(r,".png")),count:t.dropCountArray[r],maxComboCount:t.comboCountArray[r],clearCount:t.clearCountAsResult[r],comboCount:t.comboCountAsResult[r]}})},clearCountAsResult:function(){return this.bestNode?this.bestNode.comboData.cleared.map(function(t){return t.length?t.reduce(function(t,e){return t+e}):0}):new Array(this.$DROP_TYPE_MAX).fill(0)},comboCountAsResult:function(){return this.bestNode?this.bestNode.comboData.cleared.map(function(t){return t.filter(function(t){return t}).length}):new Array(this.$DROP_TYPE_MAX).fill(0)}}},We=Fe,He=(i("2dbc"),Object(Q["a"])(We,it,nt,!1,null,"0c915f90",null)),Ye=He.exports,Xe=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",t._l(t.sounds,function(t,e){return n("audio",{key:e,attrs:{id:t.id}},[n("source",{attrs:{src:i("c3e4")("./"+t.name),type:"audio/mp3"}})])}),0)},Ue=[];n["a"].prototype.$playSound=function(t){var e=document.getElementById(t);e.volume=.2,"undefined"!=typeof e.currentTime&&(e.currentTime=0),e.play()};var Ke={name:"Sounds",data:function(){return{sounds:[{id:"sound-button",name:"button.mp3"},{id:"sound-on",name:"Cyber17-1.mp3"},{id:"sound-off",name:"Cyber18-1.mp3"},{id:"sound-alert",name:"alert.mp3"}]}}},qe=Ke,Je=Object(Q["a"])(qe,Xe,Ue,!1,null,null,null),Ve=Je.exports,Ze=i("3003");function Qe(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,n)}return i}function ti(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?Qe(i,!0).forEach(function(e){Object(s["a"])(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):Qe(i).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}n["a"].use(Ze["a"]),n["a"].prototype.$DROP_TYPE_MAX=9,n["a"].prototype.$LEADER={METATRON:0,KOMASAN_S:1,AMEN:2,HYLEN:3,COCO:4,VEROAH:5,BARJULY:6},n["a"].prototype.$STATE={STANDBY:0,SEARCHING:1,SEARCH_END:2};var ei={name:"app",components:{GameArea:et,RightContainer:Ye,Sounds:Ve},data:function(){return{defaultBoard:{"5x6":[5,2,5,1,5,5,2,5,5,1,1,5,3,5,3,5,5,5,5,2,2,5,1,5,5,3,5,3,5,5],"6x7":[3,1,3,1,1,3,3,1,3,1,1,3,1,1,3,1,3,1,3,3,3,1,3,1,1,1,3,1,3,3,3,3,3,3,1,1,1,3,1,1,1,3]},board:[],timeLimit:0,stateFlag:0,gameApp:null,bestNode:null,errorMessage:"",boardSettings:{boardSize:"5x6",leader1:0,leader2:0,startPosition:-1,immovablePositions:new Set},searchSettings:{width:{min:1e3,max:5e4,step:1e3,value:1e4},depth:{min:1,max:60,step:1,value:38},diagonalMove:{min:0,max:0,step:1,value:0},enoughCombo:{min:0,step:1,value:0}},clearingSettings:{twoWay:[!0,!1,!1,!1,!1,!1,!1],breakThrough:[!0,!1,!1,!1,!1,!1,!1],line:[!0,!1,!1,!1,!1,!1,!1,!1],cross:[!0,!1,!1,!1,!1,!1,!1],L:[!0,!1,!1,!1,!1,!1,!1],required:[!0,!1,!1,!1,!1,!1,!1,!1,!1,!1],clearAll:[!0,!1,!1,!1,!1,!1,!1,!1,!1,!1],clearZero:[!0,!1,!1,!1,!1,!1,!1,!1,!1,!1]},serverAddress:{python:"http://127.0.0.1:9000/api/capture/",node:"http://127.0.0.1:1000/api/maxData/",C:"http://127.0.0.1:12345/"}}},created:function(){var t=this.boardSettings.boardSize;this.board=Array.from(this.defaultBoard[t])},computed:{process:function(){return this.bestNode?this.bestNode.process.slice(0,this.bestNode.movedCount+1):null},comboData:function(){return this.bestNode?this.bestNode.comboData:null},searchStatus:function(){return this.bestNode?this.isDanger?"DANGER":"OK":null},isDanger:function(){var t=this.boardSettings,e=t.leader1,i=t.leader2,n=this.comboData.magnification;return 1===n||e===this.$LEADER.AMEN&&i===this.$LEADER.AMEN&&1e4!==n||e===this.$LEADER.KOMASAN_S&&i===this.$LEADER.KOMASAN_S&&n%3},gameData:function(){return ti({board:this.board},this.boardSettings)},searchConditions:function(){return ti({board:this.board,maxCombo:this.maximum.combo,maxMagnification:this.maximum.magnification,beamWidth:this.searchSettings.width.value,beamDepth:this.searchSettings.depth.value,specifiedCombo:this.searchSettings.enoughCombo.value,diagonalLimit:this.searchSettings.diagonalMove.value,twoWay:this.arrayToBit(this.clearingSettings.twoWay),breakThrough:this.arrayToBit(this.clearingSettings.breakThrough),line:this.arrayToBit(this.clearingSettings.line),cross:this.arrayToBit(this.clearingSettings.cross),L:this.arrayToBit(this.clearingSettings.L),required:this.arrayToBit(this.clearingSettings.required),clearAll:this.arrayToBit(this.clearingSettings.clearAll),clearZero:this.arrayToBit(this.clearingSettings.clearZero)},this.boardSettings)}},asyncComputed:{maximum:{get:function(){var t=Object(o["a"])(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.getMaxData();case 2:return e=t.sent,t.abrupt("return",{combo:Number(e.maxComboCount),magnification:Number(e.maxMagnification)});case 4:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),default:function(){return{combo:0,magnification:1}}}},methods:{arrayToBit:function(t){var e=0;return t.forEach(function(t,i){e|=Number(t)<<i}),e},focus:function(){var t=event.target.tagName;"SELECT"!=t&&document.querySelector("#key-input").focus()},getMaxData:function(){var t=this.boardSettings,e=t.leader1,i=t.leader2,n=JSON.stringify(this.board),r=this.serverAddress["node"]+"".concat(e,"-").concat(i,"-").concat(n);return fetch(r).then(function(t){return t.json()})},capture:function(){var t=this;return fetch(this.serverAddress["python"]+this.boardSettings.boardSize).then(function(t){return t.json()}).then(function(e){t.board=e.board,t.resetSearchData(),t.startNewGame()}).catch(function(e){return t.errorMessage=e})},search:function(){var t=this;if(this.stateFlag!==this.$STATE.SEARCHING)return this.stateFlag=this.$STATE.SEARCHING,this.startNewGame(),fetch(this.serverAddress["C"],{method:"POST",body:JSON.stringify(this.searchConditions)}).then(function(t){return t.json()}).then(function(e){t.bestNode=e,t.displayLine(),t.moveOrAlert(),t.stateFlag=t.$STATE.SEARCH_END}).catch(function(e){return t.errorMessage=e})},moveOrAlert:function(){switch(this.searchStatus){case"OK":this.moveDrops(150,500);break;case"DANGER":this.$playSound("sound-alert");break}},resetHarassments:function(){this.boardSettings.startPosition=-1,this.boardSettings.immovablePositions=[]},resetSearchData:function(){this.bestNode=null,this.stateFlag=this.$STATE.STANDBY},changeLeader:function(t,e){switch(t){case 1:this.boardSettings.leader1=this.boardSettings.leader2=e;break;case 2:this.boardSettings.leader2=e;break}this.resetSearchData(),this.startNewGame()},changeBoardSize:function(t){this.boardSettings.boardSize=t,this.board=Array.from(this.defaultBoard[t]),this.resetHarassments(),this.resetSearchData(),this.startNewGame()},shuffle:function(){for(var t=[],e=0;e<this.board.length;e++)t[e]=Math.floor(6*Math.random())+1;this.board=t,this.resetHarassments(),this.resetSearchData(),this.startNewGame()},displayLine:function(){this.gameApp.displayLine(this.process)},moveDrops:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;"number"!=typeof t&&(t=100),this.gameApp.moveDrops(t,e)},startNewGame:function(){this.gameApp.startNewGame(this.gameData)}}},ii=ei,ni=(i("034f"),Object(Q["a"])(ii,r,a,!1,null,null,null)),ri=ni.exports;n["a"].config.productionTip=!0,new n["a"]({render:function(t){return t(ri)}}).$mount("#root")},"572d":function(t,e,i){},5790:function(t,e,i){"use strict";var n=i("572d"),r=i.n(n);r.a},"58f5":function(t,e,i){t.exports=i.p+"img/drop_7.4e3f38f8.png"},"63c0":function(t,e,i){"use strict";var n=i("5629"),r=i.n(n);r.a},"64a9":function(t,e,i){},"64d5":function(t,e,i){},"64f3":function(t,e,i){t.exports=i.p+"media/Cyber18-1.3e35f3c4.mp3"},7258:function(t,e,i){t.exports=i.p+"media/alert.861b9288.mp3"},7293:function(t,e,i){"use strict";var n=i("8bef"),r=i.n(n);r.a},"73d1":function(t,e,i){t.exports=i.p+"img/drop_2.b3284b0d.png"},"7c94":function(t,e,i){t.exports=i.p+"media/Cyber17-1.a746ac4e.mp3"},"804c":function(t,e,i){"use strict";var n=i("da86"),r=i.n(n);r.a},8603:function(t,e,i){"use strict";var n=i("08a2"),r=i.n(n);r.a},"8bef":function(t,e,i){},"8e46":function(t,e,i){},"8f1b":function(t,e,i){},9530:function(t,e,i){"use strict";var n=i("9907"),r=i.n(n);r.a},9907:function(t,e,i){},a1c7:function(t,e,i){t.exports=i.p+"img/immovable.1447180f.png"},a39d:function(t,e,i){},c3b5:function(t,e,i){"use strict";var n=i("64d5"),r=i.n(n);r.a},c3e4:function(t,e,i){var n={"./Cyber17-1.mp3":"7c94","./Cyber18-1.mp3":"64f3","./alert.mp3":"7258","./button.mp3":"eb62","./cursor1.mp3":"1f28","./decision3.mp3":"c643"};function r(t){var e=a(t);return i(e)}function a(t){var e=n[t];if(!(e+1)){var i=new Error("Cannot find module '"+t+"'");throw i.code="MODULE_NOT_FOUND",i}return e}r.keys=function(){return Object.keys(n)},r.resolve=a,t.exports=r,r.id="c3e4"},c643:function(t,e,i){t.exports=i.p+"media/decision3.ac43fcda.mp3"},cc8f:function(t,e,i){"use strict";var n=i("dbaa"),r=i.n(n);r.a},ce51:function(t,e,i){t.exports=i.p+"img/drop_3.657de857.png"},da86:function(t,e,i){},dbaa:function(t,e,i){},dc99:function(t,e,i){"use strict";var n=i("55df"),r=i.n(n);r.a},dd21:function(t,e,i){t.exports=i.p+"img/dragon_head_.3fc8bf9c.png"},de0b:function(t,e,i){t.exports=i.p+"img/dragon_tail_.6fca049d.png"},dedb:function(t,e,i){"use strict";var n=i("ef44"),r=i.n(n);r.a},df11:function(t,e,i){t.exports=i.p+"img/drop_6.74187f75.png"},e232:function(t,e,i){t.exports=i.p+"img/drop_8.8d075144.png"},e4cb:function(t,e,i){t.exports=i.p+"img/tile_5x6_3.51d99c14.png"},e9bc:function(t,e,i){"use strict";var n=i("1033"),r=i.n(n);r.a},eb62:function(t,e,i){t.exports=i.p+"media/button.084f5489.mp3"},ef44:function(t,e,i){},f6fd:function(t,e,i){t.exports=i.p+"img/drop_5.4943ab46.png"}});
//# sourceMappingURL=app.85ac67f7.js.map